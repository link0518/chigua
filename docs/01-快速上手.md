# 01｜快速上手

本章面向“第一次运行项目”的开发者，目标是用最少时间把项目跑起来并能访问主要页面与后台。

## 1. 环境要求

- Node.js 18+（建议 18/20/22 LTS）
- npm

## 2. 安装依赖

在仓库根目录执行：

```bash
npm install
```

## 3. 配置环境变量

项目会在后端启动时读取 `.env.local` 与 `.env`（优先 `.env.local`），前端在 Vite 模式下也会读取环境变量（见 `vite.config.ts`）。

推荐做法：

```bash
copy .env.example .env.local
```

核心字段说明（不展开示例值，避免误用生产配置）：

- `PORT`：后端 API 端口（默认 `4395`）
- `VITE_PORT`：前端 dev server 端口（默认 `4396`）
- `SESSION_SECRET`：后台会话密钥；不配置会导致后台功能禁用
- `ADMIN_USERNAME` / `ADMIN_PASSWORD`：后台账号密码；不配置会导致后台功能禁用
- `VITE_TURNSTILE_SITE_KEY` / `TURNSTILE_SECRET_KEY`：Cloudflare Turnstile；影响发帖/评论等需要人机校验的能力
- `FINGERPRINT_SALT`：指纹盐；不配会回退到 `SESSION_SECRET` 或内置默认值

## 4. 初始化数据（可选）

项目提供初始化脚本（幂等）：

```bash
npm run init-data
```

如需重置测试数据：

```bash
npm run reset-data
npm run init-data
```

## 5. 启动开发环境

分开启动（推荐用于调试）：

```bash
npm run server
npm run dev
```

一起启动（方便开发）：

```bash
npm run dev:full
```

## 6. 访问入口

- 前端：Vite dev server（默认 `4396`，可用 `VITE_PORT` 修改）
- 后端：API server（默认 `4395`，可用 `PORT` 修改）
- 后台：访问 `/tiancai`（例如 `http://localhost:4396/tiancai`）

## 7. 常见问题

### 7.1 后台提示“未启用”

原因：后端判定 `SESSION_SECRET`、`ADMIN_USERNAME`、`ADMIN_PASSWORD` 任一缺失就会禁用后台。

处理：在 `.env.local` 配齐以上字段，重启 `npm run server`。

### 7.2 前端请求 /api 失败

开发模式下前端通过 Vite 的 `proxy` 转发 `/api/*` 到后端端口（见 `vite.config.ts`）。

检查：

- 后端是否已启动并监听 `PORT`
- `PORT` 是否与 Vite proxy 指向一致

