# 07｜变更记录与文档更新流程

你要求“每次新增或修改功能都要写入文档”，本项目采用最轻量、可长期坚持的方式：**在 `CHANGELOG.md` 中人工记录**，并在必要时同步更新 `docs/` 对应章节。

## 1. 变更记录原则（强制）

每次新增/修改功能时，必须满足：

1. 更新 `CHANGELOG.md` 的 `[Unreleased]` 区块
2. 若变更影响使用方式/接口/数据结构/后台能力，必须同步更新对应 `docs/` 章节
3. 不写接口请求/响应示例（避免误贴敏感信息/生产数据）

## 2. CHANGELOG 记录模板（建议）

在 `CHANGELOG.md` 的 `[Unreleased]` 下按类型追加条目：

- `### Added`：新增功能
- `### Changed`：行为或交互变更
- `### Fixed`：修复 bug

每条建议包含：

- 用户可感知的变化点
- 影响范围（前端/后端/数据库/后台）
- 若有迁移或兼容策略，写在 `docs/03-数据模型(SQLite).md` 或本章的“注意事项”

## 3. docs/ 更新映射（什么时候该改哪份文档）

常见变更与对应文档：

- 新增/调整运行命令、端口、环境变量  
  -> `README.md`、`docs/01-快速上手.md`
- 路由/页面结构变化、前后端调用关系变化  
  -> `docs/02-架构总览.md`
- 新增表/字段、修改删除语义、计数一致性规则变化  
  -> `docs/03-数据模型(SQLite).md`
- 新增接口、接口权限/CSRF/指纹策略变化  
  -> `docs/04-后端API与权限.md`
- 后台能力变化（新增页面、按钮、动作、批处理）  
  -> `docs/05-后台管理功能.md`
- 部署方式/脚本变更、反代策略变化、备份策略变化  
  -> `docs/06-部署与运维.md`

## 4. 最小化“忘记写文档”的建议流程

你选择了方案 A（人工强制），这里给一个可执行的团队约定：

1. 开发需求时先写一句“文档影响判断”  
   - 例如：是否影响 API / 数据库 / 运维 / 使用方式
2. 功能完成后按清单自检：
   - [ ] `CHANGELOG.md` 已写
   - [ ] 相关 `docs/` 已更新（若有影响）
   - [ ] 没有粘贴敏感信息/请求示例

> 如果未来你想更强硬（例如提交时自动检查），再升级到 PR 模板或 CI 检查即可。

